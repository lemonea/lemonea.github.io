<!DOCTYPE html>
<html>
<head>
    <title>Crypto Price Monitor - Debug Version</title>
    <meta http-equiv="refresh" content="30">
    <style>
        body { font-family: Arial, sans-serif; margin: 20px; }
        .error { color: red; }
        .success { color: green; }
        .debug { background: #f0f0f0; padding: 10px; margin: 10px 0; }
    </style>
</head>
<body>
    <h2>Real-time Crypto Prices (Debug Version)</h2>
    
    <div id="ethPrice">ETH: Loading...</div>
    <div id="btcPrice">BTC: Loading...</div>
    <div id="timestamp">Updated: <span id="time">Never</span></div>
    
    <div class="debug">
        <h3>Debug Information</h3>
        <div id="debugInfo">Initializing...</div>
        <div id="errorLog"></div>
    </div>
    
    <script>
        function logDebug(message) {
            const debugDiv = document.getElementById('debugInfo');
            debugDiv.innerHTML += '<br>' + new Date().toLocaleTimeString() + ': ' + message;
            console.log(message);
        }
        
        function logError(error) {
            const errorDiv = document.getElementById('errorLog');
            errorDiv.innerHTML += '<div class="error">' + new Date().toLocaleTimeString() + ': ERROR - ' + error + '</div>';
            console.error(error);
        }
        
        async function updatePrices() {
            logDebug('Starting price update...');
            
            try {
                // Test 1: ETH Price
                logDebug('Fetching ETH price...');
                const ethResponse = await fetch('https://api.binance.com/api/v3/ticker/price?symbol=ETHUSDT');
                
                if (!ethResponse.ok) {
                    throw new Error(`ETH API responded with status: ${ethResponse.status}`);
                }
                
                const ethData = await ethResponse.json();
                document.getElementById('ethPrice').textContent = `ETH: $${ethData.price}`;
                logDebug(`ETH price updated: $${ethData.price}`);
                
                // Test 2: BTC Price
                logDebug('Fetching BTC price...');
                const btcResponse = await fetch('https://api.binance.com/api/v3/ticker/price?symbol=BTCUSDT');
                
                if (!btcResponse.ok) {
                    throw new Error(`BTC API responded with status: ${btcResponse.status}`);
                }
                
                const btcData = await btcResponse.json();
                document.getElementById('btcPrice').textContent = `BTC: $${btcData.price}`;
                logDebug(`BTC price updated: $${btcData.price}`);
                
                // Update timestamp
                document.getElementById('time').textContent = new Date().toLocaleTimeString();
                logDebug('Price update completed successfully');
                
            } catch (error) {
                logError(`Failed to update prices: ${error.message}`);
                
                // Try alternative API endpoint
                try {
                    logDebug('Trying alternative endpoint...');
                    const response = await fetch('https://api1.binance.com/api/v3/ticker/price?symbol=ETHUSDT');
                    const data = await response.json();
                    document.getElementById('ethPrice').textContent = `ETH: $${data.price} (alt)`;
                    logDebug('Alternative endpoint worked');
                } catch (altError) {
                    logError(`Alternative endpoint also failed: ${altError.message}`);
                }
            }
        }
        
        // Test browser capabilities
        logDebug('Browser: ' + navigator.userAgent);
        logDebug('Fetch API available: ' + (typeof fetch !== 'undefined'));
        logDebug('Starting initial update...');
        
        updatePrices();
        setInterval(updatePrices, 15000); // Update every 15 seconds
    </script>
</body>
</html>
